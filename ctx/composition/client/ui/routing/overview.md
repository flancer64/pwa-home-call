# Обзор подсистемы Router

Path: `./ctx/composition/client/ui/routing/overview.md`

## Назначение Router

Router представляет собой навигационный механизм клиентского UI. Он устанавливает связь между hash-частью URL и отображаемым экраном, обеспечивает загрузку соответствующего шаблона, передачу параметров и инициализацию контроллера. Подсистема формирует единообразную модель переходов между экранами без участия серверной конфигурации и без влияния на бизнес-логику приложения.

Router ориентирован на управление представлением UI: определяет, какой экран должен быть активен, и поддерживает предсказуемый жизненный цикл экранов, включая размонтирование предыдущих и корректное монтирование новых.

## Роль Router в составе UI

- обеспечивает навигацию внутри приложения через hash-based маршруты;
- формирует структуру маршрута и связывает её с экраном;
- управляет последовательностью отображения экранов;
- остаётся изолированным от потоков данных и механизмов звонка.

Router работает только в рамках UI-композиции и не расширяет ответственности Flow или StateMachine.

## Границы ответственности

### Включено

- анализ hash-части URL и сопоставление её с таблицей экранов;
- вызов загрузчика шаблонов для получения HTML-представления экрана;
- создание и инициализация контроллера экрана;
- передача параметров маршрута экрану;
- управление жизненным циклом экранов: монтирование, размонтирование;
- управление fallback-маршрутом `not-found`.

### Исключено

- изменение состояния звонка;
- участие в сценариях, определяемых Flow;
- работа с WebRTC, Media, Signal и другими контрами;
- манипуляции внутренними структурами данных приложения.

## Fallback-маршрут

Router поддерживает механизм fallback для случаев, когда URL не соответствует известному маршруту. В таких ситуациях Router инициирует переход на экран `not-found`. Fallback обеспечивает:

- устойчивость навигации при вводе некорректных ссылок;
- предсказуемость композиции UI;
- исключение пустых или неопределённых экранных состояний.

Экран `not-found` является автономным элементом представления и не взаимодействует с Flow.

## Взаимодействие с другими подсистемами UI

### TemplatesLoader

Предоставляет шаблон экрана по имени. Router использует его для получения статического представления.

### ScreenController

Отвечает за поведение экрана. Router передаёт контроллеру параметры и инициирует lifecycle-методы.

### Flow

Определяет сценарии и состояния звонка. Router не изменяет и не управляет этим уровнем.

### StateMachine

Определяет допустимые переходы состояний звонка. Router не участвует в этих переходах.

## Архитектурная позиция

Router представляет собой навигационный уровень, связывающий URL → шаблон → контроллер → экран. Он дополняет слои UI-композиции и обеспечивает управляемую маршрутизацию без пересечения с логическими и сетевыми механизмами приложения.
