# Поток: Мгновенное соединение по кнопке «Связать»

## Цель
Показать полностью обновлённый путь: от домашнего экрана до активной медиасессии, внутри которой инициатор может передать ссылку, а получатель присоединяется без дополнительных окон.

## Участники
- **Инициатор** — открывает приложение и запускает сеанс.
- **Получатель** — получает ссылку внутри звонка и попадает в тот же сеанс без ручного выбора.

## Предусловия
- Браузер имеет доступ к камере и микрофону.
- Сеанс ещё не создан; домашний экран показывает единственную кнопку **Связать**.

## Основной поток
1. Домашний экран сохраняет минимализм: одна большая кнопка **Связать** и краткий текст о том, что сеанс создаётся мгновенно.
2. После нажатия **Связать** приложение очищает параметры URL, запускает WebRTC-сеанс и остаётся в том же окне. Появляется локальное превью и чёрное поле для удалённого потока, внутри которого написано «Ждём собеседника». Такой переход отражает `capabilities/connection.md`.
3. Пока собеседник не подключился, инициатор может нажать **Отправить ссылку** (см. `capabilities/link-sharing.md`), выбрать Shared API или скопировать ссылку вручную. Ссылка формируется «внутри» текущего сеанса и считается активной до его завершения.
4. Получатель получает ссылку через выбранный канал, открывает её — браузер автоматически читает параметр `session` и присоединяет к уже существующему сеансу; пользователь сразу видит видео и индикаторы связи, а инициатор наблюдает замену чёрного поля на живой поток.
5. Общение идёт внутри одного окна, камера и микрофон доступны, состояние переключается между «Ожидание» и «Подключено», а завершение происходит при нажатии кнопки выхода или закрытии вкладки.

## Альтернативные потоки
- А1. Shared API недоступен — кнопка **Отправить ссылку** переходит в режим копирования, и инициатор вручную вставляет ссылку в сообщение. Эта информация сохранена и понятна для пожилых пользователей, поскольку интерфейс подчёркивает, что ссылка уже создана.
- А2. Получатель нажимает ссылку, но соединение проходит медленно — инициатор видит индикатор «Ждём собеседника» и расширенный текст: «Если ничего не происходит, повторно нажмите «Отправить ссылку»».

## Постусловия
- Сеанс активен до принципа закрытия окна или выхода, ссылка деактивируется после завершения.
- Получатель подключился без форм или экранов приглашения, а инициатор может запустить новый сеанс снова с кнопки «Связать».

## Устаревшее поведение
Раньше инициатор переходил на отдельный экран приглашения, чтобы скопировать ссылку до звонка; сейчас этот шаг лишний, потому что медиасессия уже открыта, и ссылка создаётся внутри неё по требованию.
