# Архитектура приложения HomeCall (обзор)

## Назначение

HomeCall — Node.js-приложение, созданное по философии **TeqFW** с использованием контейнера `@teqfw/di`, который интегрирован через пакет **@flancer32/teq-web**. Оно предоставляет прогрессивное веб-приложение (PWA) для семейной видеосвязи.

## Основные компоненты

1. **Node.js-приложение** — единый процесс, обслуживающий запросы, управляемый DI-контейнером.
2. **Сервер `@flancer32/teq-web`** — HTTP-слой, использующий `@teqfw/di` для инициализации модулей и раздачи статических ресурсов PWA.
3. **Файловое хранилище** — сохраняет рабочие данные (например, сведения о пользователях) в формате JSON без использования баз данных.
4. **PWA-клиент** — устанавливается в браузер и обновляется автоматически при изменении версии кода на сервере.
5. **Архитектура развёртывания** — фронтенд (статика в `./web/`, обслуживаемая Apache) и бэкенд (Node.js API, запускаемый поверх `@flancer32/teq-web`).

## Связь архитектуры и окружений

Архитектура определяет логическую структуру и роли компонентов HomeCall. Документы `./arch/env/apache.md` и `./arch/env/node.md` конкретизируют инфраструктурные параметры развёртывания для каждого уровня окружения, сохраняя связь с этим архитектурным описанием. Дополнительная детализация зафиксирована в `./arch/linkage.md`.

## Конфигурация окружения

Все сетевые и системные параметры backend-приложения передаются через файл `.env`, описанный в документе `./arch/env/config.md`.  
Этот механизм обеспечивает согласованность между архитектурными декларациями и фактическим окружением Node.js и Apache.  
Параметры (`PORT`, `WS_PORT`, `HOST_PUBLIC`, `NODE_ENV`) определяют доступность API, канал сигналинга и внешний адрес приложения.

## Версионирование и обновления

- Каждая сборка PWA имеет уникальный номер версии, отражённый в манифесте.
- Сервер при каждом запросе отдаёт актуальную версию кода.
- Сервис-воркер на клиенте автоматически обновляет локальную копию при обнаружении новой версии.

## Ссылки

- `./arch/env/apache.md` — окружение Apache.
- `./arch/env/node.md` — окружение Node.js.
- `./arch/linkage.md` — связь архитектуры и окружений.
- `./arch/teqfw.md` — проектные правила TeqFW.
- `./arch/teqfw/di.md` — универсальные принципы DI.
- `./arch/teqfw/module-template.md` — шаблон модулей, используемый при генерации кода.
- `./arch/testing.md` — правила модульного тестирования.
- `./codex.md` — влияние когнитивного слоя на генерацию кода.

## Итог

Минимальная архитектура: одно Node.js-приложение управляет раздачей, хранением переменных данных и механизмом обновления PWA без внешних зависимостей, опираясь на контейнер `@teqfw/di` для согласованного управления компонентами.
