# Entry Page

**Path:** `ctx/rules/web/ui/page/index.md`

## Назначение

`/index.html` — точка входа веб-приложения, формирующая минимальное окружение для запуска DI-контейнера и `app.js`. Страница не принадлежит экранным сценариям, не использует трёхзонную модель и не подключает UI-компоненты уровня `screen/`.

> **Согласованность с продуктом:** `ctx/product/overview.md` говорит о едином окне с непрерывным состоянием, поэтому точка входа должна только запускать `app.js` и не вмешиваться в экранный поток (`ready/waiting/active`). Текущая реализация всё ещё описывает `home`, `invite`, `call`, `end`, а будущая перестройка state machine зафиксирована в `ctx/agent/plan/2025/11/20251129-rules-implementation-fixes.md`.

## Роль

- Обеспечивает гарантированный запуск приложения.
- Определяет факт успешной инициализации исключительно по состоянию DOM корневого контейнера.
- Обеспечивает устойчивость к сбоям загрузки без участия экранной логики и без переходов.

## Инварианты загрузки

- Успешная загрузка определяется появлением **содержимого в корневом контейнере приложения** (`#app`), отражающего инициализацию UI.
- Отсутствие содержимого в этом контейнере после разумного ожидания трактуется как невозможность запуска приложения.
- Страница не использует специфичных маркеров, не опирается на атрибуты (`data-*`) и не требует от экранов дополнительных сигналов.
- Проверка успешности не зависит от версии, сервис-воркера или сетевого состояния.

## Поведение при сбоях

- Если приложение не проявляет признаков инициализации, страница обязана перейти в безопасное статическое состояние и **отобразить пользователю предложение восстановить приложение**.
- Восстановление выполняется **только после явного подтверждения пользователя**; автоматическое восстановление недопустимо.
- Утверждённый пользователем цикл восстановления приводит окружение в согласованное состояние (очищенные кеши, сброшенные регистраций сервис-воркеров, чистый запуск).
- При отсутствии согласия страница остаётся в статичном состоянии и не выполняет повторных попыток запуска, перезагрузок и скрытых восстановлений.

## Требуемое поведение точки входа

- Страница должна уметь обнаруживать невозможность запуска независимо от причин (ошибка модулей, повреждённый кэш, несогласованность сервис-воркера, нарушение целостности сборки).
- Обнаружение должно основываться **только на наблюдаемом поведении DOM** и не требовать сетевых запросов.
- Вся функциональность восстановления должна быть доступна без зависимости от `app.js`, инициализации DI или других модулей.

## Связи

- `./reinstall.md` — ручной путь восстановления, использующий те же инфраструктурные инварианты.
- `../../infra/pwa.md` — политика кешей и поведения сервис-воркера.
- `../../app.md` — состояние приложения после успешной инициализации.
