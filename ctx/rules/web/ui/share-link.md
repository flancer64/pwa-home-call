# Share Link Mechanism

**Путь:** ./ctx/rules/web/ui/share-link.md

## Назначение

Этот документ описывает, как ДомоЗвон превращает одно нажатие «Позвонить» в одноразовую ссылку, понятную пожилым пользователям, и как поддерживается обратная связь без лишних навигационных областей.

## URL-шаблон

- Ссылка всегда формируется по шаблону: `https://<домен>/?room=<uuid>`.
- UUID создаётся автоматически при нажатии «Позвонить» и действителен только в рамках текущей сессии.
- `room` берётся из URL, имя (`name`) — из `localStorage`; имя никогда не включается в URL.
- Получатель открывает ту же ссылку, `home` считывает `room`, подставляет сохранённое имя и подключает пользователя к комнате.

## Расшаривание

1. Инициатор нажимает «Позвонить» и получает `toast` «Ссылка готова» (см. `notifications.md`).
2. Система сначала вызывает Web Share API, если он доступен, и предлагает хранилище (например, SMS или мессенджер), не раскрывая технических подробностей пользователю.
3. Если API недоступен, применяется fallback:
   - ссылка копируется в буфер обмена;
   - отображается `toast` «Ссылка скопирована», а пользователю предлагается использовать привычный канал связи.
4. В интерфейсе не появляется отдельный экран invite, все действия происходят в `home`/`share-link`.

## Приём ссылки

- Получатель открывает ссылку — `home` считывает `room` из URL и имя (если сохранено) из `localStorage`.
- Автоматическое подключение начинается без дополнительных кликов; если имя не найдено, появляется форма ввода (как при первом запуске) и после сохранения соединение продолжается.
- Сценарий совпадает с `ctx/product/scenarios/primary-call.md` и `daily-use.md`: единственный поток без ручного выбора комнат.

## Статусы и feedback

- `toast`-уведомления сообщают о готовности ссылки, копировании, ошибках Web Share и сбоях сети.
- Нет дополнительных событий интерфейса вроде `ui:action:share-link`; генерация ссылки происходит внутри `home` и управляется состоянием компонента.
- Не используются дополнительные управляющие панели, индикаторы WS/RTC или ручные настройки — только короткие сообщения для объяснения текущего шага.

## Связи

- `ctx/product/features/invite.md` — бизнес-ценность автоматического приглашения.
- `screens.md` и `home.md` — путь, в котором формируется ссылка и происходит переход к `call`.
- `notifications.md` — текстовые статусы «Ссылка готова», «Ссылка скопирована», ошибки меди/связи.
