# Toolbar

## Назначение

Определяет состав и поведение верхней панели управления (toolbar) приложения ДомоЗвон.

---

## 1. Общая структура

- Левая часть — индикаторы состояния соединения (`ws`, `rtc`).
- Центральная часть — информационный блок (имя пользователя, название комнаты, иконка статуса).
- Правая часть — выпадающее меню (гамбургер), содержащее настройки, выход и справку.
- На мобильных устройствах — элементы схлопываются в меню; на десктопах выводятся как отдельные кнопки.

---

## 2. Индикаторы состояния

| Индикатор | Значение                       | Цвета                                                        |
| --------- | ------------------------------ | ------------------------------------------------------------ |
| **WS**    | состояние WebSocket-соединения | зелёный — подключено; серый — отключено; красный — ошибка    |
| **RTC**   | состояние P2P-сессии           | зелёный — активна; серый — нет соединения; жёлтый — ожидание |

---

## 3. Информационный блок

- Отображает текущую комнату и пользователя.
- Может включать время звонка или статус «ожидание соединения».
- В десктопном режиме — центрируется; в мобильном — скрывается при активном видео.

---

## 4. Меню (гамбургер)

- Элементы: настройки, очистка кэша, сведения, выход.
- В десктопной версии — часть пунктов (очистка, настройки) выведены отдельными иконками.
- Меню вызывается по нажатию на иконку `menu.svg`.
- Опция `Поделиться ссылкой` доступна инициатору (например, в `enter`, `lobby`, `call`, `end`) и инициирует событие `ui:action:share-link`.

### Действие «Поделиться ссылкой» (инициатор)

- `ui:action:share-link` инициирует `HomeCall_Web_Core_App`, который открывает `HomeCall_Web_Ui_Screen_Invite` и передаёт текущие `room`/`name`. Экран `invite` позволяет инициатору ввести имя приглашённого и комнату назначения и не запускает подключение к сигнализации.
- При подтверждении (`invite:confirm`) `invite` формирует URL (`room` и `name`) и отвечает за вызов `navigator.share()` и/или fallback-копирования через `navigator.clipboard.writeText`; `HomeCall_Web_Ui_Toast` уведомляет об успешной отправке, ошибках API или необходимости использовать буфер обмена.
- После `invite:confirm` или `invite:cancel` инициатор возвращается в предыдущее состояние интерфейса — Core не прерывает текущий поток `enter → lobby → call → end → lobby`.
- Пункт меню/toolbar доступен из любых состояний интерфейса (если UX-дизайн не запрещает его во время активного звонка), но является ручной функцией и не входит в основной пользовательский поток.

---

## 5. Адаптивность

- При ширине <768 px панель схлопывается: индикаторы и информация скрываются, доступ через меню.
- При ширине ≥768 px панель разворачивается, все элементы отображаются.

---

## 6. Связи

- `./layout.md` — общая структура экранов.
- `../style.md` — визуальные параметры.
- `../arch/front.md` — архитектурная реализация.
- `ctx/product/features/invite.md` — продуктовая функция «Приглашение через ссылку».
