# Экранный контур ДомоЗвона

**Путь:** ./ctx/rules/web/ui/screens.md

Этот документ фиксирует единственный пользовательский поток `home → call → end` без промежуточных состояний и дополнительных навигационных панелей. Все переходы основаны на продуктовых сценариях (`ctx/product/scenarios/*`) и отражают концепцию однокнопочного вызова с автоматической ссылкой.

## Назначение

Экранный контур согласован с `ctx/product/overview.md`, `features.md` и сценариями `first-run`, `daily-use` и `primary-call`. Он гарантирует:

- автоматическое создание комнаты и генерацию ссылки при едином нажатии;
- отсутствие ручного выбора собеседников, ручного ввода комнаты или дополнительных состояний;
- быстрый путь получателя: по ссылке — прямое подключение.

## Состояния

1. **home**
   - Содержит форму ввода имени (только если оно не сохранено) и одну большую кнопку «Позвонить».
   - После генерации ссылки активируется `share-link.md` с описанием Web Share API и fallback; любые статусные сообщения приходят только как `toast` (см. `notifications.md`).
2. **call**
   - Показывает поток собеседника на фоне и миниатюру локального видео; встроенные сообщения о статусе подключения отсутствуют, чтобы оставить экран простым.
   - Единственное действие — кнопка «Завершить».
   - Все статусы и ошибки отображаются через `toast`, экран не содержит дополнительных надписей или индикаторов.
3. **end**
   - Сообщает о результате звонка, предлагает вернуться на `home`.
   - После простого объяснения кнопка «Главный экран» возвращает к началу.

## Переходы

- `home → call`: нажата кнопка «Позвонить», система создала UUID-комнату, ссылка готова и инициатор ждёт подключения собеседника; при этом appliation state переходит к `call`.
- `call → end`: завершение вызова со стороны любого участника, сетевой сбой или нажатие «Завершить» очищают медиаресурсы и переводят в `end`.
- `end → home`: пользователь подтверждает завершение и возвращается на главный экран; состояние готовности восстанавливается с учётом сохранённого имени и очищенной ссылки.

При переподключении UI остаётся в состоянии `call`; все статусы передаются через `toast`, без переходов на другие экраны.

## Дополнения

- `share-link.md` описывает самоформируемую ссылку (`https://<домен>/?room=<uuid>`), Web Share API и fallback на копирование + toast «Ссылка готова / Ссылка скопирована».
- `notifications.md` уточняет нужные уведомления: готовность ссылки, ошибки медиа/связи, другие `toast`-статусы без дополнительных визуальных сигналов.

## Связи

- `ctx/product/overview.md`, `features.md` и `features/invite.md` — описывают ценность однокнопочного вызова, автоматическую генерацию комнаты и линк-ориентированность.
- `ctx/product/scenarios/first-run.md`, `daily-use.md`, `primary-call.md` — детали сохранения имени, ежедневного использования и основного потока.
- `home.md`, `share-link.md`, `screens/call.md`, `screens/end.md` — конкретные описания структур экранов.
