# Файловая структура фронтенда

## Назначение

Документ определяет состав и назначение файлов фронтенд-части **Колобок**, реализованной как статическое PWA-приложение.  
Цель — зафиксировать минимальный каркас каталогов и файлов, достаточный для генерации и развёртывания клиентской части.

Каждый подкаталог (`core`, `ui`, `media`, `net`, `rtc`, `env`, `shared`) представляет собой отдельный **контур**, описывающий часть поведения браузерного приложения. Эти контуры объединяются в систему, определённую в `app.md`.

## Границы и интерфейсы

Документ не описывает внутренние классы или DI-структуру, он фиксирует только файловое окружение и соответствие каталогов архитектурным контурам, выявленным в `app.md`.

---

## 1. Общая структура каталога `web/`

```text
web/
├── index.html            # Точка входа, подключает app.js и регистрирует service-worker.js
├── app.js                # Главный модуль управления состояниями приложения
├── manifest.json         # Манифест PWA (иконки, имя, цвета, ориентация)
├── service-worker.js     # Сервис-воркер: кеширование, обновления, офлайн-режим
├── ws/                   # Модули WebSocket-сигналинга
│   └── client.js
├── rtc/                  # Модули WebRTC-подключений
│   └── peer.js
├── ui/                   # Компоненты интерфейса (фрагменты экранов)
│   ├── home.html
│   ├── invite.html
│   ├── call.html
│   └── end.html
├── assets/               # Иконки, стили, статические ресурсы
│   ├── style.css
│   └── icons/
└── version.json          # Текущая версия сборки (для обновления PWA)
```

> Note: `ui/lobby.html` stays in the repository for legacy reasons, but the active UI flow now goes through `home`, `invite`, `call`, and `end`; the lobby screen is excluded from the service worker cache list.

---

## 2. Принципы организации

- Каталог `web/` полностью автономен и не содержит серверного кода.
- Все пути относительные; приложение работает при раздаче напрямую с Apache или другого статического сервера.
- Логика загрузки и оркестрации приложения начинается с `app.js`, который запускает систему контуров, описанную в `app.md`.
- Структура экранов (`ui/`) следует описанию из `./ui/screens.md`.
- Модули `rtc/` и `ws/` реализуют логику соединений, не зависящую от UI.
- `service-worker.js` кэширует только файлы, указанные в `manifest.json`.
- Любые новые подкаталоги должны быть отражены в этом документе и следовать тем же правилам именования.

---

## 3. Связи

- `./app.md` — обзорное поведение браузерного приложения Колобок.
- `../arch/front.md` — архитектура фронтенд-части.
- `./ui/screens.md` — модель экранов и состояний интерфейса.
- `./pwa.md` — поведение PWA и обновление версии.
- `./rtc.md` — реализация WebRTC и сигналинг.
- `./style.md` — принципы визуального оформления.

---

## Итог

Документ задаёт базовый каркас клиентской структуры Колобок и отражает, как каталоги и файлы поддерживают контуры, описанные в `app.md`.  
Он обеспечивает единообразие при генерации и развёртывании статического PWA, согласуя расположение всех модулей и файлов.  
См. также `app.md` — обзорный документ браузерного приложения Колобок.
