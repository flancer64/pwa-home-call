# Frontend HomeCall (`ctx/rules/arch/front.md`)

## Назначение

Документ фиксирует архитектуру фронтенд-части **HomeCall** — прогрессивного веб-приложения (PWA), обеспечивающего видеосвязь между пользователями через **WebRTC** и **WebSocket-сигналинг**.
Фронтенд автономен, разворачивается как статика в каталоге `./web/`, обновляется через сервис-воркер и взаимодействует с backend по API и каналу сигналинга.

## 1. Структура и роли

- **PWA (Single Page Application)** — одноэкранное приложение, устанавливаемое на смартфон, обеспечивает UI, авторизацию по кодовому слову и управление вызовами.
- **WebRTC-слой** — устанавливает прямые соединения и обрабатывает аудио/видео-потоки.
- **WebSocket-клиент** — обеспечивает сигналинг: обмен SDP/ICE и онлайн-статусом участников.
- **Service Worker** — кэширует ресурсы, обновляет приложение и обеспечивает офлайн-доступ.
- **Manifest.json** — задаёт метаданные установки (иконку, имя, цвет темы).

## 2. Взаимодействие компонентов

1. Пользователь открывает PWA → приложение подключается к WebSocket-серверу сигналинга.
2. Сервер возвращает список активных участников и код комнаты.
3. При вызове обмениваются SDP/ICE через WebSocket, после чего трафик идёт напрямую по WebRTC.
4. Service Worker отслеживает обновления версии фронтенда.

## 3. Размещение и окружение

- Фронтенд хранится в `web/`.
- Раздаётся **Apache** из `DocumentRoot /var/www/homecall/web`.
- API-запросы и WebSocket-трафик проксируются к Node.js через `/api/*` и `/ws/*`.

## 4. Связи с другими документами

- `../architecture.md` — общий архитектурный обзор.
- `../web/ui/screens.md` — структура пользовательских экранов и интерфейсные состояния.
- `./back.md` — серверная часть.
- `./env/apache.md` — конфигурация веб-сервера.
- `./structure.md` — структура каталогов проекта.

## Итог

Фронтенд HomeCall — компактное PWA-приложение с WebRTC и WebSocket-сигналингом, размещённое как статический ресурс.
Документ задаёт минимальную декларативную основу для построения и развития клиентской части проекта.
