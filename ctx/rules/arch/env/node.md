# Компонент: Node.js Backend

## Назначение

Node.js-окружение обеспечивает выполнение серверной части **Колобок**, включая API и канал сигналинга WebSocket.  
Оно инициализирует пакет `@flancer32/teq-web`, который встраивает контейнер зависимостей `@teqfw/di` для управления модулями приложения.

---

## 1. Структура и окружение

- Версия Node.js ≥ 20 LTS, режим ESM.
- Точка входа — `bin/server.js`.
- Основные каталоги:
  - `src/` — исходный код приложения;
  - `data/` — переменные данные в формате JSON;
  - `web/` — статические ресурсы фронтенда (PWA).
- Приложение выполняется в одном процессе на `127.0.0.1:$PORT`; значения `PORT` и `WS_PORT` задаются через `.env`.

---

## 2. npm-пакеты

| Пакет                             | Назначение                                                          |
| --------------------------------- | ------------------------------------------------------------------- |
| `@flancer32/teq-web`              | HTTP-слой и интеграция с DI-контейнером.                            |
| `@teqfw/di`                       | Управление зависимостями и жизненным циклом модулей.                |
| `dotenv`                          | Загрузка конфигурации окружения из `.env`.                          |
| `ws`                              | WebSocket-сервер для обмена SDP/ICE-сообщениями (сигналинг WebRTC). |
| `node:test`, `node:assert/strict` | Средства модульного тестирования.                                   |

Эти пакеты формируют минимальный стек backend-окружения и обеспечивают совместимость с архитектурой TeqFW.

---

## 3. Назначение контейнера

Пакет `@flancer32/teq-web` встраивает `@teqfw/di`, обеспечивая создание и связывание компонентов, описанных в архитектурных документах.  
Все зависимости разрешаются через контейнер, а бизнес-логика сосредоточена в модулях под `src/Back/`.

---

## 4. Ссылки

- `../../node/bin/server.md` — правила генерации головного скрипта (`composition root`).
- `../architecture.md` — архитектурный обзор и требования к окружению.
- `../back/signal.md` — реализация WebSocket-сигналинга.
- `../linkage.md` — схема согласования архитектуры и окружений.
- `./apache.md` — конфигурация внешнего HTTP-сервера.
- `./config.md` — перечень параметров `.env`, необходимых для запуска Node.js и WebSocket-сервера.

---

## Итог

Node.js-окружение Колобок определяет исполняемую среду для HTTP-API и сигналинга WebRTC.  
Оно основано на `@flancer32/teq-web` и `@teqfw/di`, использует пакет `ws` для WebSocket-сервера и полностью согласовано с архитектурными декларациями проекта.
