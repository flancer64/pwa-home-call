# Универсальные принципы контейнера @teqfw/di

## Назначение

Документ описывает принципы использования контейнера зависимостей **@teqfw/di** во всех проектах TeqFW и служит опорой для проектных правил `../teqfw.md`.

## Платформа

- `@flancer32/teq-web` — Node.js-обёртка, предоставляющая HTTP-слой и использующая `@teqfw/di` для управления зависимостями.
- Контейнер поддерживает ESM и применяется в приложениях без привязки к конкретному фреймворку.

## Применение DI

- **Late binding** — зависимости разрешаются при запросе, что упрощает замену и тестирование модулей.
- **Inversion of Control (IoC)** — контейнер управляет созданием экземпляров и их жизненным циклом.
- **ESM-совместимость** — модули пишутся в формате ECMAScript Modules без использования `require`.
- **Naming-схема** — идентификаторы повторяют структуру каталогов: `Namespace_Component` ↔ `Namespace/Component.js`.

## Экспорт и внедрение

- Один модуль отвечает за одну роль (`Data`, `Logic`, `Service` и т.д.).
- Допустимые экспорты: объект, фабрика или класс по умолчанию; конструктор принимает `{ deps }`.
- Все зависимости передаются в виде плоского объекта `deps`; вложенные разрешения не допускаются.

## Жизненный цикл

- Контейнер создаётся один раз на приложение и выдаёт экземпляры по требованию.
- Singleton-компоненты кэшируются; множественные экземпляры создаются через ключ `$$`.
- Подмена зависимостей моками допускается через явное переопределение резолверов.

## Связанные документы

- `../teqfw.md` — проектные правила применения этих принципов.
- `../../architecture.md` — архитектурный обзор HomeCall, указывающий на роль DI.

## Результат

Универсальные правила DI, описанные здесь, обеспечивают единообразие проектов TeqFW и используются как базовая ссылка для всех производных документов.
