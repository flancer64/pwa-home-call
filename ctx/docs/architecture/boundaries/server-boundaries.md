# Архитектурные границы серверного узла

Path: `./ctx/docs/architecture/boundaries/server-boundaries.md`

## Назначение

Фиксировать границы внутри серверного узла, определяя, какие данные и инварианты пересекают интерфейсы между хранителем сеанса, сигнальным маршрутизатором и окружением.

## Хранитель сеанса ↔ Сигнальный маршрутизатор

- Маршрутизатор сопоставляет архитектурные события с `sessionId`, но не хранит пользовательскую нагрузку; хранитель сеанса обеспечивает, что каждый `sessionId` остаётся уникальным и очищается после завершения.
- Граница фиксирует stateless-инварианты: никакие события не переиспользуют `sessionId`, пока сервер не зафиксирует завершение.
- Маршрутизатор не раскрывает структуру событий: он передаёт декларации `предложение`, `ответ`, `кандидат`, `завершение`, `ошибка` хранителю, и тот фиксирует наличие контекста.

## Хранитель сеанса ↔ Окружение

- Окружение предоставляет платформенные параметры и наблюдаемость, но не вмешивается в архитектурную форму `sessionId`.
- Хранитель сеанса остаётся нейтральным к инфраструктуре (TLS, reverse-proxy, systemd) и не вводит очередей или длительных stateful-хранилищ ради этих параметров.
- Граница гарантирует, что окружение может наблюдать и считывать декларации, но не модифицирует их без явного согласия серверного контекста.

## Сигнальный маршрутизатор ↔ Окружение

- Маршрутизатор сигналинга работает внутри архитектурной формы и не раскрывает низкоуровневые каналы окружения.
- Окружение обеспечивает условия исполнения, но не участвует в упорядочивании событий или симметрии `sessionId`.
