# Архитектурная форма сигнального обмена

Path: `./ctx/docs/architecture/shapes/signal/AGENTS.md`

## Назначение

Фиксировать закрытый перечень архитектурных событий и инвариантов сигнального контура, соединяющего клиентские и серверные узлы без описания JSON, SDP, WebSocket или процедурных деталей.

## Архитектурные события

- **Предложение соединения** — декларация желания начать `sessionId`, фиксирующая минимальные требования к готовности партнёров.
- **Ответ** — подтверждение второго участника, закрепляющее симметрию и единство контекста.
- **Кандидат** — архитектурная метка о появлении дополнительной транспортной опции без раскрытия ICE/SDP.
- **Завершение** — регистрация перехода в фазу окончания и обязательство очистить контекст.
- **Ошибка** — сигнал о нарушении инвариантов (несовпадение `sessionId`, потеря симметрии) без указания способа восстановления.

Каждое событие привязано к одному `sessionId`, не вводит новых ролей и не расширяет допустимый список фаз.

## Границы и маршрутизация

Сигнальный контур маршрутизирует события между клиентами и сервером, не храня очередей и не раскрывая способы доставки: архитектурные события либо пересекли границу, либо нет. Клиент может объявить `предложение`, сервер подтверждает `ответ`, а `кандидат` дополняет готовность, оставаясь в пределах архитектурной формы.

## Инварианты

- Все события идентифицируются одним `sessionId`.
- Маршрутизация сохраняет симметрию: ни один участник не получает преференций по ролям.
- Сигнальный контур не раскрывает транспортную структуру и опирается на `ctx/docs/constraints/session.md` для порядка.

## Карта уровня

- `AGENTS.md` — индекс сигнального пространства с описанием событий, границ и инвариантов.
