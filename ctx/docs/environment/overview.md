# Окружения узла связи Связист

Path: `./ctx/docs/environment/overview.md`

## Назначение

Документ описывает эксплуатационные контуры, которые поддерживают архитектурные инварианты Связист: внешний HTTP/HTTPS-слой, Node.js-процесс сигналинга и взаимодействие контейнеров зависимостей с окружением.

## Apache + PWA

- Фронтенд собирается в статические артефакты (`web/`) и отдаётся внешнему HTTP/HTTPS-серверу Apache, которому нужны только каталог статики и маршруты `/signal` и `/api` (`ctx/docs/environment/cfg/apache.md`).
- Service worker, описанный в `ctx/docs/environment/pwa.md`, обеспечивает автономный загрузчик, детерминированную версионность (`version.json`) и предсказуемое очищение кэша при смене сборки.
- Apache отвечает за TLS и проксирование, а также за приведение публичного адреса `HOST_PUBLIC` к инфраструктурным требованиям.

## Node.js и `.env`

- `bin/server.js` загружает `.env` через `dotenv` и форсирует обязательные параметры `PORT`, `WS_PORT`, `HOST_PUBLIC` и `NODE_ENV` (`ctx/docs/environment/cfg/config.md`).
- Значения этих переменных определяют публичные и внутренние порты, адреса сигналинга и режим исполнения, обеспечивая согласованное поведение HTTP/API и WebSocket-сигналинга без дублирования архитектурных контрактов.

## Связь с окружениями

- TLS, systemd и logrotate описаны в соответствующих документах `ctx/docs/environment/cfg/apache.md`, `ctx/docs/environment/cfg/systemd.md` и `ctx/docs/environment/cfg/logrotate.md`, где закреплены требования к сертификатам, автозапуску и ротации логов.
- Требования к WebSocket-соединению и runtime-поведение сигналинга — каталог `ctx/docs/environment/ws-runtime.md` — приводят эти окружения в соответствие архитектурной форме `ctx/docs/architecture/messaging.md`.
- Все окружения поддерживают stateless-природу сервера и ограничение двумя участниками, введённое в `ctx/docs/constraints/node.md`.

---

Этот документ перенесён из `ctx/docs/architecture/overview.md` в рамках нормализации уровней ADSM.
