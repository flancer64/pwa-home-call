# Call layout HomeCall

Путь: `ctx/docs/composition/client/ui/layout/call.md`

## Назначение

Фиксирует макет `active`: видеоцентрированный интерфейс, в котором медиапотоки и контролы складываются слоями, чтобы дать приоритет погружению и свободному пространству для статусов.

## Состав

- **Удалённый поток (`remoteStream`)** занимает всю поверхность вьюпорта и создаёт фон сценки, оставаясь за всеми прочими слоями.
- **Локальная миниатюра (`localStream`)** закреплена в одном из углов, визуально отделена от основного видео и может перемещаться без переработки остального layout’а.
- **Оба видеослота** (main-video и overlay-video) используют стратегию заполнения кадра object-fit: cover, чтобы видео занимало всю доступную площадь своего контейнера. Допускается обрезка по краям для сохранения полноэкранного эффекта и предотвращения «втискивания» изображения.
- **FAB-панель** располагает две круглые кнопки (`settings` и `hangup`) у нижнего центра; кнопки закреплены в `fab-panel` и плавают над видео, не перекрывая ключевые области удалённого сигнала.
- **Акустика.** До подключения удалённого участника `main-video` показывает локальный поток в `muted`-режиме, а после появления `remoteStream` фон начинает воспроизводить звук; локальная миниатюра `overlay-video` по-прежнему остаётся без звука.
- Layout сохраняет палитру, тени и типографику из `ctx/docs/composition/client/ui/patterns/style.md`, поэтому описывает только размещение элементов без новых цветов.
- Макет построен edge-to-edge: видеофон и прокладки растягиваются на весь viewport без внутренних `max(env(safe-area-inset-*), 16px)` padding’ов. Safe-area применяется только при позиционировании плавающих слоёв (`call-controls`, `call-local`, toast-layer и другие FAB-элементы), которые используют `env(safe-area-inset-*)` для `bottom`/`top`/`right`, чтобы оставаться на безопасном расстоянии от вырезов и системных панелей.
- Все геометрические правила видеослотов описаны в `web/ui/screen/call.css`: `#main-video` остаётся абсолютным (`inset: 0`) слоем с `object-fit: cover` и фоном `#000`, а `call-local` — плавающий контейнер с `safe-area`-смещениями, внутри которого `overlay-video` также применяет `object-fit: cover`.

## Статусы и взаимодействия

- Статусы доносятся через `ctx/docs/composition/client/ui/patterns/toast-layer.md`, чтобы сам макет оставался свободным от текстовых подсказок и Footer-зоны.
- Контролы `fab-panel` определяют цвета, тени и размеры кнопок (см. `patterns/fab-panel`) без описания поведения.

## Связи

- `ctx/docs/composition/client/ui/patterns/fab-panel.md` — панель, которая повторно используется в call и overlay`ах.
- `ctx/docs/composition/client/ui/patterns/toast-layer.md` — тосты кладутся на тот же горизонтальный край, что и FAB-панель.
