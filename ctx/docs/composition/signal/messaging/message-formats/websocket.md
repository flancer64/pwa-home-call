# Форматы сообщений сигналинга WebSocket

Путь: `ctx/docs/composition/signal/messaging/message-formats/websocket.md`

## Назначание

Содержит строго фактические строки JSON, которыми обмениваются клиенты через `wss://<host>/signal` в рамках одного `sessionId`.

## Форматы

| Тип            | Поля                                    | Описание                           |
| -------------- | --------------------------------------- | ---------------------------------- |
| `"offer"`     | `sessionId`, `sdp`                      | SDP-предложение, отправляемое первым подключившимся участником. |
| `"answer"`    | `sessionId`, `sdp`                      | SDP-ответ, отправляемый вторым подключившимся участником.       |
| `"candidate"` | `sessionId`, `candidate`                 | ICE-кандидаты, применяемые для установки media-канала.         |
| `"hangup"`    | `sessionId`, `reason?`                  | Нотификация о завершении сеанса, причину отправитель передаёт по желанию. |
| `"error"`     | `sessionId`, `message`, `code?`         | Сообщение об ошибке сигналинга, отображаемое в `call`-макете. |

Каждое сообщение обязательно содержит `sessionId`, что позволяет клиенту связать его с текущим UI-фрагментом (`ctx/docs/composition/client/ui-states/states.md`).

## Контекст

- Сообщения передаются внутри одного окна (`ready → waiting → active → ended`) и не приводят к новой навигации.
- Сервер только ретранслирует JSON внутри `sessionId`, без дополнительных комнат или списков, и не сохраняет роли: любой отправитель `hangup` просто завершает контекст, а очередь FIFO сохраняется до подключения второго участника.
