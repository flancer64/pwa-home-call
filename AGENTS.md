# AGENTS.md — универсальная инструкция для LLM-агентов

## Назначение

Этот файл является корневой точкой входа для LLM-агентов во всех проектах, реализующих методологию ADSM (Agent-Driven Software Management).
Он описывает общие принципы взаимодействия Человека и Агента, минимальную структуру проекта и ссылки на локальные инструкции.
Файл читается агентом первым, до загрузки контекстов и специфик проекта.

---

## Принципы ADSM

- Управление проектом осуществляется через диалог Человека и Агента.
- Проект включает два взаимосвязанных пространства:

  - Контекст (`./ctx/`) — смысл, описания, спецификации, правила.
  - Продукт — код, данные, интерфейсы или иные исполняемые артефакты.

- Человек формирует цели и проверяет результаты.
- Агент интерпретирует контекст и изменяет продукт в его рамках.
- Каждая итерация завершается отчётом Агента.

---

## Роли

Человек отвечает за:

- формулирование целей и управление контекстом;
- утверждение изменений и развитие структуры проекта.

Агент отвечает за:

- выполнение задач в пределах контекста;
- генерацию и редактирование кода или описаний;
- сохранение согласованности структуры и терминов;
- фиксацию результатов в отчётах.

---

## Минимальная структура проекта

Пример базовой структуры:

```text
/
├─ ctx/         ← когнитивный контекст (обязательный каталог)
├─ AGENTS.md    ← корневая инструкция для LLM-агентов
└─ README.md    ← человекочитаемое описание проекта
```

Расположение исходного кода, данных и интерфейсов определяется самим проектом и не фиксируется методологией.

---

## Контекстные зависимости

Каждый проект уточняет поведение Агента через собственные документы внутри каталога `./ctx/`.

Рекомендуемые ссылки:

- `ctx/agent/overview.md` — локальные правила и протоколы работы агента;
- `ctx/rules/architecture.md` — архитектурные принципы и структура;
- `ctx/product/overview.md` — цели и назначение продукта.

Если в проекте присутствуют дополнительные инструкции вне `ctx/`, например `web/AGENTS.md`, агент должен:

1. Считать их частью контекста.
2. Придерживаться требований в них, когда работает в соответствующем пространстве (например, `web/`).
3. Указывать ссылки на такие инструкции в отчёте, чтобы сохранять прозрачность выполняемой работы.

---

## Правила обработки комментариев `@LLM-DOC`

**Обязательное правило для всех агентов и всех исходных файлов проекта.**

Комментарии, начинающиеся с метки `@LLM-DOC`, являются встроенной документацией исходного кода.
Они фиксируют архитектурные решения и служат источником контекста при анализе и генерации кода.
Агенты должны их учитывать, но не изменять.

**Формальные требования:**

1. Метка `@LLM-DOC` может встречаться только в исходных файлах проекта (например, `.js`, `.mjs`, `.py`, `.java` и т. д.).
2. Все комментарии в коде пишутся **только на английском языке**.
3. Агенты обязаны:

   - распознавать строки, начинающиеся с `@LLM-DOC`, как защищённые;
   - не редактировать, не удалять и не дополнять такие комментарии;
   - использовать их как достоверный контекст при генерации и проверке кода.

**Инвариант ADSM:**
Любое изменение, удаление или дополнение комментариев с меткой `@LLM-DOC` считается нарушением методологии
и квалифицируется как `execution error`.

---

## Отчётность и формат фиксации итераций

Агент по завершении **каждой** итерации формирует краткий отчёт в формате Markdown.
Запись создаётся в каталоге `./ctx/agent/report/YYYY/MM/DD/HH-MM-{title}.md`, содержит резюме изменений и достигнутые результаты.
Отчётность обязательна и служит основным каналом обратной связи для разработчиков.
**Отсутствие отчёта делает итерацию несостоявшейся и считается ошибкой выполнения задачи.**

**Жёсткое правило:**

- Агент **обязан** завершать каждую итерацию созданием отчёта.
- Завершение итерации без отчёта трактуется как `execution error`.
- Проверка наличия отчёта — обязательный шаг перед формированием финального ответа.
- Если отчёта нет, агент должен создать новый файл автоматически.

**Алгоритм фиксации результата:**

1. Перед завершением работы агент проверяет наличие актуального файла отчёта в `ctx/agent/report/` за текущую дату и время.
2. Если запись отсутствует, агент создаёт новый файл, фиксируя:

   - цель итерации;
   - предпринятые действия;
   - достигнутые артефакты и результаты.

3. После создания отчёта агент может завершить итерацию и вернуть результат Человеку.

Рекомендуется использовать шаблон отчёта `ctx/agent/report-template.md` при его наличии.

---

## Совместимость

Этот файл определяет инварианты методологии ADSM и может использоваться без изменений во всех проектах.
Локальные отклонения описываются только в подкаталогах `./ctx/`.
